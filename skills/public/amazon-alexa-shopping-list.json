{
    "title": "Amazon - Get Alexa Shopping List",
    "description": "Login to Amazon and extract active shopping list items via the Alexa API",
    "may_require_mfa": true,
    "instructions": [
        "If you see a 'Passkey', 'QR code', or 'Continue shopping' prompt, click 'Cancel' or the close button immediately.",
        "Complete the login process with the credentials provided.",
        "After login, IMMEDIATELY navigate to the API endpoint URL.",
        "The API returns raw JSON with 'listItems' nested inside a dynamic key."
    ],
    "final_url": "https://www.amazon.com/alexashoppinglists/api/getlistitems",
    "steps": [
        {
            "type": "setViewport",
            "width": 1280,
            "height": 800,
            "deviceScaleFactor": 1
        },
        {
            "type": "navigate",
            "url": "https://www.amazon.com"
        },
        {
            "type": "click",
            "target": "main",
            "selectors": [
                ["#nav-link-accountList"],
                ["aria/Account & Lists"],
                ["text/Account & Lists"]
            ],
            "comment": "Click Account & Lists to start login"
        },
        {
            "type": "change",
            "value": "{{AMAZON_EMAIL}}",
            "selectors": [
                ["#ap_email"],
                ["#ap_email_login"],
                ["name/email"],
                ["aria/Enter your mobile number or email"]
            ],
            "comment": "Enter email"
        },
        {
            "type": "click",
            "target": "main",
            "selectors": [
                ["#continue"],
                ["#continue input"],
                ["aria/Continue"],
                ["text/Continue"]
            ],
            "comment": "Click Continue"
        },
        {
            "type": "waitForElement",
            "selectors": [
                ["#ap_password"],
                ["text/Cancel"],
                ["aria/Cancel"]
            ],
            "timeout": 5000,
            "comment": "Wait for password field OR Passkey cancel button"
        },
        {
            "type": "change",
            "value": "{{AMAZON_PASSWORD}}",
            "selectors": [
                ["#ap_password"],
                ["name/password"],
                ["aria/Password"]
            ],
            "comment": "Enter password"
        },
        {
            "type": "click",
            "target": "main",
            "selectors": [
                ["#signInSubmit"],
                ["aria/Sign in"],
                ["text/Sign in"]
            ],
            "comment": "Click Sign In"
        },
        {
            "type": "navigate",
            "url": "https://www.amazon.com/alexashoppinglists/api/getlistitems",
            "comment": "Navigate to API endpoint after login"
        }
    ],
    "env_vars": {
        "AMAZON_EMAIL": "Amazon Email",
        "AMAZON_PASSWORD": "Amazon Password",
        "AMAZON_OTP_SECRET": "Optional: TOTP Secret for 2FA"
    },
    "extract_prompt": "Use parse_page_json with array_key='listItems', filter_key='completed', filter_value=False, extract_fields=['value']. The tool will search nested objects for 'listItems'. Return: {\"shopping_list\": [{\"item_name\": \"<value>\", \"quantity\": 1}, ...]}"
}
