{
    "title": "Walmart - Search and Add to Cart",
    "description": "Login to Walmart, search for items, find previously purchased in-stock items, and add to cart",
    "workflow_type": "shopping_list_to_cart",
    "accepts_input": {
        "shopping_list": "Array of items to search for and add to cart"
    },
    "steps": [
        {
            "type": "setViewport",
            "width": 1280,
            "height": 800,
            "deviceScaleFactor": 1
        },
        {
            "type": "navigate",
            "url": "https://www.walmart.com/account/login?returnUrl=/cart"
        },
        {
            "type": "click",
            "target": "main",
            "selectors": [
                ["#email"],
                ["aria/Email Address"],
                ["input[type='email']"]
            ]
        },
        {
            "type": "change",
            "value": "{{WALMART_EMAIL}}",
            "selectors": [
                ["#email"],
                ["input[type='email']"]
            ]
        },
        {
            "type": "click",
            "target": "main",
            "selectors": [
                ["button[type='submit']"],
                ["text/Continue"],
                ["aria/Continue"]
            ]
        },
        {
            "type": "click",
            "target": "main",
            "selectors": [
                ["#password"],
                ["aria/Password"],
                ["input[type='password']"]
            ]
        },
        {
            "type": "change",
            "value": "{{WALMART_PASSWORD}}",
            "selectors": [
                ["#password"],
                ["input[type='password']"]
            ]
        },
        {
            "type": "click",
            "target": "main",
            "selectors": [
                ["button[type='submit']"],
                ["text/Sign In"],
                ["aria/Sign In"]
            ]
        },
        {
            "type": "waitForElement",
            "selectors": [
                ["#global-search-input"],
                ["aria/Search"],
                ["input[name='query']"]
            ],
            "timeout": 15000
        }
    ],
    "env_vars": {
        "WALMART_EMAIL": "Walmart Email",
        "WALMART_PASSWORD": "Walmart Password"
    },
    "task_prompt": "You are now logged into Walmart. For EACH item in the shopping list provided, do the following:\n\n1. Search for the item using the search bar\n2. Look at the search results and find items that show 'Bought X times' or 'Purchased before' badge - these indicate you've bought them before\n3. Check that the item is IN STOCK (not 'Out of stock' or 'Unavailable')\n4. If a previously-purchased, in-stock item is found, click 'Add to cart'\n5. If no previously-purchased item is found, look for a similar in-stock item and add that instead\n6. Move to the next item on the list\n\nDO NOT proceed to checkout. Stop after adding all items to cart.\n\nReturn a JSON summary: {\"items_added\": [...], \"items_not_found\": [...], \"cart_total\": \"$X.XX\"}",
    "extract_prompt": "Report which items were successfully added to cart, which could not be found, and the current cart total. Return: {\"items_added\": [{\"name\": \"...\", \"price\": \"$X.XX\", \"previously_purchased\": true/false}], \"items_not_found\": [\"item1\", \"item2\"], \"cart_total\": \"$X.XX\"}"
}
